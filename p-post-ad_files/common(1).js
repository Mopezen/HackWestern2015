Kj.Utilities=function(){var a={"init":function(a){if(this.checkPassedArgs(a),this.opt=a,"undefined"==typeof dust)throw new Error("kjTemplate - dust.js library not found. Please ensure dust is loading");return this.render()},"checkPassedArgs":function(a){if(Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"Options object"}),Kj.Utilities.verifyPassedArgs({"val":a.template,"required":!0,"typeofString":"string","name":"template"}),"undefined"==typeof dust.cache[a.template])throw new Error('kjTemplate - "'+a.template+'" - No such template found, did you compile it and register it in the page JS controller?');Kj.Utilities.verifyPassedArgs({"val":a.data,"required":!0,"typeofString":"object","name":"data"})},"render":function(){var a="",b=this;return dust.render(b.opt.template,b.opt.data,function(c,d){c&&console&&console.error&&console.error("kjTemplate - "+b.opt.template,c),a=d}),a}},b={"init":function(a){return this.checkPassedArgs(a),this.opt=a,this.runThroughData(),this.opt.dataCheck},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.dataCheck,"required":!0,"typeofString":"object","name":"dataCheck"}),Kj.Utilities.verifyPassedArgs({"val":a.dataDefault,"required":!0,"typeofString":"object","name":"dataDefault","lengthMin":!0})},"runThroughData":function(){var a;for(a in this.opt.dataDefault)this.opt.dataDefault.hasOwnProperty(a)&&this.replaceData(a)},"replaceData":function(a){("undefined"==typeof this.opt.dataCheck[a]||null===this.opt.dataCheck[a]||""===this.opt.dataCheck[a])&&(this.opt.dataCheck[a]=this.opt.dataDefault[a])}},c={"init":function(a){this.opt=a,this.verifyValue()},"verifyValue":function(){var a="undefined"==typeof this.opt.val||null===this.opt.val,b=this.opt.required===!0,c=a&&b,d=typeof this.opt.val!==this.opt.typeofString,e="object"===this.opt.typeofString,f=e&&!a&&this.opt.val.constructor===Array,g="string"===this.opt.typeofString,h=""===$.trim(this.opt.val),i=this.opt.lengthMin===!0;if(c)throw new Error("Please define '"+this.opt.name+"'");if(!a){if(d)throw new Error("Please define the '"+this.opt.name+"' as a "+this.opt.typeofString);if(f&&i&&this.opt.val.length<=0)throw new Error("Please define '"+this.opt.name+"' keys");if(e&&i&&_.size(this.opt.val)<=0)throw new Error("Please define '"+this.opt.name+"' keys");if(g&&h&&i)throw new Error("Please do not leave '"+this.opt.name+"' empty")}}},d={"init":function(a){return this.checkPassedArgs(a),this.opt=a,this.changeQuery()},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.url,"required":!0,"typeofString":"string","name":"url"}),Kj.Utilities.verifyPassedArgs({"val":a.paramName,"required":!0,"typeofString":"string","name":"paramName","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.paramValue,"required":!0,"typeofString":"string","name":"paramValue","lengthMin":!0})},"changeQuery":function(){for(var a,b=this.opt.url.replace(/^[?]/,""),c=/([^&=]+)=([^&]*)/g,d={};a=c.exec(b);){var e=decodeURIComponent(a[1].replace("+"," ","g"));d[e]=decodeURIComponent(a[2].replace("+"," ","g"))}return"fl"!==this.opt.paramName&&"locationId"!==this.opt.paramName||!$.isNumeric(this.opt.paramValue)||(this.opt.paramValue=this.opt.paramValue%1e8),d[this.opt.paramName]=this.opt.paramValue,$.param(d)}},e={"init":function(a){return this.checkPassedArgs(a),this.opt=a,this.getQuery()},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.url,"required":!1,"typeofString":"string","name":"url"}),Kj.Utilities.verifyPassedArgs({"val":a.paramName,"required":!0,"typeofString":"string","name":"paramName","lengthMin":!0})},"getQuery":function(){var a=this.getUrlVars();return"undefined"==typeof this.opt.paramName?a:"undefined"==typeof a[this.opt.paramName]?"":a[this.opt.paramName]},"getUrlVars":function(){var a=this.opt.url||window.location.href;return _.chain(a.slice(a.indexOf("?")+1).split("&")).map(function(a){return a?a.split("="):void 0}).compact().object().value()}},f={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.openWindowPopUp()},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.url,"required":!0,"typeofString":"string","name":"url"}),Kj.Utilities.verifyPassedArgs({"val":a.specs,"required":!0,"typeofString":"object","name":"specs","lengthMin":!0})},"openWindowPopUp":function(){window.open(this.opt.url,"_blank",this.getSpecString())},"getSpecString":function(){var a,b="";for(a in this.opt.specs)this.opt.specs.hasOwnProperty(a)&&(b+=a+"="+this.opt.specs[a]+",");return b}};return{"test":{"kjTemplate":a,"replaceDefaults":b,"verifyPassedArgs":c,"changeUrlParam":d,"getUrlParam":e,"WindowPopUp":f},"replaceDefaults":function(a){return b.init(a)},"useTemplate":function(b){return a.init(b)},"verifyPassedArgs":function(a){return c.init(a)},"changeUrlParam":function(a){return d.init(a)},"getUrlParam":function(a){return e.init(a)},"initWindowPopUp":function(a){f.init(a)},"getPartialUrl":function(a){return a+".html"}}}();;Kj.Tracking=function(){var a={"init":function(a){this.startWebTrends()},"startWebTrends":function(){this.isWTLuckyNumber()&&this.isWebTrendsDefined()&&(_tag=new WebTrends,_tag.dcsGetId(),_tag.dcsCollect())},"isWTLuckyNumber":function(){var a="luckynumber",b=$.cookie(a);if(null===b){b=Math.floor(1e6*Math.random());var c=new Date;c.setTime(c.getTime()+2592e6),$.cookie(a,b,{"domain":Kj.extVars.domainUrl,"expires":c,"path":"/"})}return 100>b%1e3},"isWebTrendsDefined":function(){return"undefined"!=typeof WebTrends}},b={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.trackEvent()},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.event,"required":!0,"typeofString":"string","name":"event","lengthMin":!0})},"trackEvent":function(){Kj.Tracking.isWTLuckyNumber()&&dcsMultiTrack("DCSext.event",this.opt.event)}},c={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.trackEvent()},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.action,"required":!0,"typeofString":"string","name":"action","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.label,"required":!1,"typeofString":"string","name":"label"}),Kj.Utilities.verifyPassedArgs({"val":a.delayHref,"required":!1,"typeofString":"string","name":"delayHref","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.delayForm,"required":!1,"typeofString":"object","name":"delayForm"}),Kj.Utilities.verifyPassedArgs({"val":a.event,"required":!1,"typeofString":"object","name":"event"}),Kj.Utilities.verifyPassedArgs({"val":a.nonInteraction,"required":!1,"typeofString":"boolean","name":"nonInteraction"})},"trackEvent":function(){var a={"event":this.opt.action,"eventLabel":this.optionalLabel()};this.hasNonInteraction()===!0&&(a.uaNonInt=this.nonInteractionValue()),Kj.Tracking.updateDataLayer({"param":a}),this.callZoop(a),this.isOpenWindow()===!0&&this.openWindow(),this.isDelayed()&&this.delay()},"optionalLabel":function(){return"undefined"!=typeof this.opt.label?this.opt.label:""},"delay":function(){var a=this.getDelayFunction();setTimeout(a,100)},"isDelayed":function(){return"undefined"!=typeof this.opt.delayHref&&this.isOpenWindow()===!1||"undefined"!=typeof this.opt.delayForm},"getDelayFunction":function(){var a,b=this;return"undefined"!=typeof this.opt.delayHref?a=function(){document.location.href=b.opt.delayHref}:"undefined"!=typeof this.opt.delayForm&&(a=function(){b.opt.delayForm.trigger({"type":"submit","trackEvent":!0})}),a},"isOpenWindow":function(){return"undefined"!=typeof this.opt.event&&"undefined"!=typeof this.opt.delayHref&&this.openWindowKeyDown()===!0},"openWindowKeyDown":function(){return this.opt.event.metaKey===!0||this.opt.event.ctrlKey===!0},"openWindow":function(){window.open(this.opt.delayHref,"_blank")},"hasNonInteraction":function(){return"undefined"!=typeof this.opt.nonInteraction},"nonInteractionValue":function(){return this.opt.nonInteraction===!0?1:0},"callZoop":function(a){Zoop.hasBeenInitialized()===!0&&Zoop.callEvent({"data":{"e":a}})}},d={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.trackSocialEvent()},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.network,"required":!0,"typeofString":"string","name":"network","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.action,"required":!0,"typeofString":"string","name":"action","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.target,"required":!0,"typeofString":"string","name":"target","lengthMin":!0})},"trackSocialEvent":function(){var a={"event":"social","socialEvent":{"network":this.opt.network,"action":this.opt.action,"target":this.opt.target}};Kj.Tracking.updateDataLayer({"param":a})}},e={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.updateDataLayer()},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.param,"required":!0,"typeofString":"object","name":"param","lengthMin":!0})},"updateDataLayer":function(){dataLayer.push(this.opt.param)}},f={"init":function(){this.cache(),this.bindListeners()},"cache":function(){this.dom={"categoryLinks":$(".category-selected")}},"bindListeners":function(){var a=this;a.dom.categoryLinks.on({"click":function(b){a.trackEvent($(this),b)}})},"trackEvent":function(a,b){var c={"action":"CategorySelected","label":this.populateLabel(a.attr("data-id"))};this.isNewWindow(a)===!1&&(b.preventDefault(),c.delayHref=a.attr("href"),c.event=b),Kj.Tracking.trackGAEvent(c)},"populateLabel":function(a){return"catId="+a+";locID="+Kj.extVars.tracking.locId+";"},"isNewWindow":function(a){var b=a.attr("target");return"undefined"!=typeof b&&"_blank"===b}},g={"init":function(){this.cache(),this.bindListeners()},"cache":function(){this.dom={"locationLinks":$(".location-selected"),"locationForm":$("#FormLocationPicker"),"locationIdInput":$("#LocationIdInput")}},"bindListeners":function(){var a=this;a.dom.locationLinks.on({"click":function(b){b.preventDefault(),a.trackLink({"id":$(this).attr("data-id"),"href":$(this).attr("href"),"catRoot":$(this).hasClass("location-hp"),"event":b})}})},"populateLabel":function(a,b){var c="catId=";return c+=b!==!0&&"undefined"!=typeof Kj.extVars.tracking.catId&&""!==Kj.extVars.tracking.catId?Kj.extVars.tracking.catId:"0",c+";locID="+a+";"},"trackLink":function(a){Kj.Tracking.trackGAEvent({"action":"LocationSelected","label":this.populateLabel(a.id,a.catRoot),"delayHref":a.href,"event":a.event})},"trackForm":function(a){Kj.Tracking.trackGAEvent({"action":"LocationSelected","label":this.populateLabel(a.id,a.catRoot),"delayForm":this.dom.locationForm})}},h={"init":function(){this.cache(),this.bindListeners()},"cache":function(){this.dom={"attributeLinks":$("a.attribute-selected"),"attributeForm":$("form.attribute-selected")}},"bindListeners":function(){var a=this;a.dom.attributeLinks.on({"click":function(b){b.preventDefault(),a.trackLink({"event":$(this).attr("data-event"),"href":$(this).attr("href"),"label":a.populateLabelForLink($(this)),"eventObj":b})}})},"hasAttributeId":function(a){return"undefined"!=typeof a.attr("data-id")&&""!==a.attr("data-id")},"attributeValue":function(a){return a.attr("data-id")},"populateLabelForLink":function(a){var b=this.labelCatLoc();return this.hasAttributeId(a)&&(b+="value="+this.attributeValue(a)+";"),b},"populateLabelForForm":function(a){var b=this,c=b.labelCatLoc(),d=1;return a.each(function(){c+="value"+d+"="+$(this).val()+";",d++}),c},"labelCatLoc":function(){var a=0,b=0;return"undefined"!=typeof Kj.extVars.tracking.catId&&""!==Kj.extVars.tracking.catId&&(a=Kj.extVars.tracking.catId),"undefined"!=typeof Kj.extVars.tracking.locId&&""!==Kj.extVars.tracking.locId&&(b=Kj.extVars.tracking.locId),"catId="+a+";locId="+b+";"},"trackLink":function(a){Kj.Tracking.trackGAEvent({"action":a.event,"label":a.label,"delayHref":a.href,"event":a.eventObj})},"trackForm":function(a){Kj.Tracking.trackGAEvent({"action":a.event,"label":this.populateLabelForForm(a.form.find("input[type=text]")),"delayForm":a.form})}},i={"init":function(){this.cache(),this.bindListeners()},"cache":function(){this.dom={"$postAdButtons":$(".edit-ad-begin")}},"bindListeners":function(){var a=this;a.dom.$postAdButtons.on({"click":function(b){b.preventDefault(),a.trackButton($(this),b)}})},"trackButton":function(a,b){Kj.Tracking.trackGAEvent({"action":"EditAdBegin","label":this.populateLabel(a),"delayHref":this.getButtonHref(a),"event":b})},"getButtonHref":function(a){return a.attr("href")},"getButtonLocation":function(a){return a.attr("data-btn-loc")},"populateLabel":function(a){return"btn="+this.getButtonLocation(a)+";"}},j={"init":function(){this.cache(),this.bindListeners()},"cache":function(){this.dom={"$postAdButtons":$(".post-ad-begin")}},"bindListeners":function(){var a=this;a.dom.$postAdButtons.on({"click":function(b){b.preventDefault(),a.trackButton($(this),b)}})},"trackButton":function(a,b){Kj.Tracking.trackGAEvent({"action":"PostAdBegin","label":this.populateLabel(a),"delayHref":this.getButtonHref(a),"event":b})},"getButtonHref":function(a){return a.attr("href")},"getButtonLocation":function(a){return a.attr("data-btn-loc")},"populateLabel":function(a){return"btn="+this.getButtonLocation(a)+";"}},k={"init":function(){this.cache(),this.defaults(),this.bindListeners()},"cache":function(){this.dom={},this.dom.$forms=$("form.track-form-flow"),this.dom.$formInputs=this.dom.$forms.find("input[type=text], input[type=password], textarea, select")},"defaults":function(){this.userBegan=[]},"bindListeners":function(){var a=this;this.dom.$forms.on({"submit":function(b){return a.submitLoginForm(b,$(this))}}),this.dom.$formInputs.on({"focus":function(){a.inputOnFocus($(this))}})},"submitLoginForm":function(a,b){return Kj.Forms.api.Button.disableButton(Kj.Forms.api.Button.getFormSubmitButton(b)),this.isTrackingSubmit(a)?this.validateForm(b):(this.trackAttemptEvent(b),!1)},"isTrackingSubmit":function(a){return"undefined"!=typeof a.trackEvent&&a.trackEvent===!0},"inputOnFocus":function(a){var b=this.getForm(a);this.trackBeginEvent(b)},"trackBeginEvent":function(a){var b=this.getFormId(a),c=this.getFormActionTitle(a);this.hasFormBegan(b)===!1&&(Kj.Tracking.trackGAEvent({"action":c+"Begin"}),this.addFormBegan(b))},"trackAttemptEvent":function(a){var b=this.getFormActionTitle(a);this.trackBeginEvent(a),Kj.Tracking.trackGAEvent({"action":b+"Attempt","delayForm":a})},"validateForm":function(a){var b=this.isFormValid(a),c=this.getFormActionTitle(a),d=Kj.Forms.api.Button.getFormSubmitButton(a);return b===!1&&(Kj.Forms.api.Button.enableButton(d),Kj.Tracking.trackGAEvent({"action":c+"Fail"})),b},"isFormValid":function(a){return Kj.Forms.initValidateForm({"form":a,"showInputMessages":!0,"showBoxMessages":!1})},"hasFormBegan":function(a){return this.userBegan.indexOf(a)>=0},"addFormBegan":function(a){this.userBegan.push(a)},"getFormActionTitle":function(a){return a.attr("data-action-title")},"getFormId":function(a){return a.attr("id")},"getForm":function(a){return a.closest("form.track-form-flow")}},l={"init":function(){return this.defaults(),this.getPageDetails()},"defaults":function(){this.dataLayer=dataLayer},"getPageDetails":function(){var a,b=this.dataLayer.length,c=0;for(c;b>c;c++)if(this.isPageDetails(this.dataLayer[c])===!0){a=this.dataLayer[c];break}return a},"isPageDetails":function(a){return this.hasKey(a,"l")&&this.hasKey(a,"c")?!0:!1},"hasKey":function(a,b){return"undefined"!=typeof a[b]?!0:!1}},m={"init":function(){return this.defaults(),this.dataLayerHasOrderDetails()===!0&&this.populateOrderDetails(),this.orderDetails},"defaults":function(){this.pageDetails=Kj.Tracking.initDataLayerPageDetails(),this.orderDetails={"hasPayment":!1,"hasFeatures":!1,"hasListingFee":!1}},"populateOrderDetails":function(){var a=this.pageDetails.o.oi,b=a.length,c=0;for(this.orderDetails.hasPayment=!0,c;b>c;c++)this.isListingFee(a[c])===!0?this.orderDetails.hasListingFee=!0:this.orderDetails.hasFeatures=!0},"isListingFee":function(a){return"Listing Fee"===a.prd.n||"INSERTION_FEE"===a.prd.n},"dataLayerHasOrderDetails":function(){return"undefined"!=typeof this.pageDetails&&"undefined"!=typeof this.pageDetails.o&&"undefined"!=typeof this.pageDetails.o.oi}},n={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.defaults(),this.trackEvents()},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.actionType,"required":!0,"typeofString":"string","name":"actionType","lengthMin":!0})},"defaults":function(){this.hasActivationErrors=Kj.Tracking.initHasAdActivationError(),this.orderDetails=Kj.Tracking.initOrderInvoiceInDataLayer()},"trackEvents":function(){this.orderDetails.hasPayment===!0&&this.trackSuccess("Payment"),this.orderDetails.hasFeatures===!0&&this.trackSuccess("FeatureAd"),this.hasActivationErrors.hasErrors===!1&&(this.orderDetails.hasListingFee===!0?this.trackSuccess(this.opt.actionType+"AdPaid"):this.trackSuccess(this.opt.actionType+"AdFree"))},"trackSuccess":function(a){Kj.Tracking.trackGAEvent({"action":a+"Success"})}},o={"init":function(){this.defaults(),this.trackEvents()},"defaults":function(){this.orderDetails=Kj.Tracking.initOrderInvoiceInDataLayer()},"trackEvents":function(){this.orderDetails.hasPayment===!0&&this.trackSuccess("Payment"),this.orderDetails.hasFeatures===!0&&this.trackSuccess("FeatureAd")},"trackSuccess":function(a){Kj.Tracking.trackGAEvent({"action":a+"Success"})}},p={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.defaults(),this.trackEvent()},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.isDealer,"required":!0,"typeofString":"boolean","name":"isDealer"})},"defaults":function(){this.hasUserLoggedIn=Kj.Utilities.getUrlParam({"url":location.href,"paramName":"uli"}),this.hasUserLoggedOut=Kj.Utilities.getUrlParam({"url":location.href,"paramName":"ula"}),this.hasProUserLoggedIn=Kj.Utilities.getUrlParam({"url":location.href,"paramName":"pli"}),this.hasUserRegistered=Kj.Utilities.getUrlParam({"url":location.href,"paramName":"ua"})},"trackEvent":function(){"true"===this.hasUserLoggedIn&&Kj.Tracking.trackGAEvent({"action":"UserLoginSuccess"}),"true"===this.hasUserLoggedOut&&Kj.Tracking.trackGAEvent({"action":"UserLogoutSuccess"}),"true"===this.hasProUserLoggedIn&&Kj.Tracking.trackGAEvent({"action":"ProUserLoginSuccess"}),"true"===this.hasUserRegistered&&Kj.Tracking.trackGAEvent({"action":this.registeredActionTitle()})},"registeredActionTitle":function(){return this.opt.isDealer===!0?"ProUserRegistrationSuccess":"UserRegistrationSuccess"}},q={"init":function(){this.defaults(),this.trackEvent()},"defaults":function(){this.hasEdited=Kj.Utilities.getUrlParam({"url":location.href,"paramName":"edited"})},"trackEvent":function(){"true"===this.hasEdited&&Kj.Tracking.initTrackActionAdSuccess({"actionType":"Edit"})}},r={"init":function(){this.defaults(),this.trackEvent()},"defaults":function(){this.hasEdited=Kj.Utilities.getUrlParam({"url":location.href,"paramName":"edited"}),this.hasPosted=Kj.Utilities.getUrlParam({"url":location.href,"paramName":"posted"})},"trackEvent":function(){"true"!==this.hasEdited&&Kj.Tracking.initTrackActionAdSuccess({"actionType":"Post"})}},s={"init":function(){return this.defaults(),this.populateActivationErrors(),this.activationErrors},"defaults":function(){this.activationErrors={"hasErrors":!1,"errorCode":""},this.hasNotOwnerOfAd=Kj.Utilities.getUrlParam({"url":location.href,"paramName":"notOwnerOfAd"}),this.hasAdAlreadyActivated=Kj.Utilities.getUrlParam({"url":location.href,"paramName":"adAlreadyActivated"})},"populateActivationErrors":function(){"true"===this.hasNotOwnerOfAd&&this.setActivationError("hasNotOwnerOfAd"),"true"===this.hasAdAlreadyActivated&&this.setActivationError("hasAdAlreadyActivated"),Kj.extVars.tracking.adOrUserNotFound===!0&&this.setActivationError("adOrUserNotFound")},"setActivationError":function(a){this.activationErrors.hasErrors=!0,this.activationErrors.errorCode=a}},t={"init":function(){this.defaults(),this.trackEvents()},"defaults":function(){this.hasActivationErrors=Kj.Tracking.initHasAdActivationError(),this.actionTitle="ActivateAd",this.hasAdActivatedLink=Kj.Utilities.getUrlParam({"url":location.href,"paramName":"activateLink"})},"trackEvents":function(){this.hasActivationErrors.hasErrors===!0?this.trackFailure(this.hasActivationErrors.errorCode):"true"===this.hasAdActivatedLink&&this.trackSuccess()},"trackFailure":function(a){this.trackAttempt(),Kj.Tracking.trackGAEvent({"action":this.actionTitle+"Fail","label":"err="+a+";"})},"trackSuccess":function(){this.trackAttempt(),Kj.Tracking.trackGAEvent({"action":this.actionTitle+"Success"})},"trackAttempt":function(){Kj.Tracking.trackGAEvent({"action":this.actionTitle+"Attempt"})}},u={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.defaults(),this.trackFeatureEnabledOnPageLoad()},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.hasEnabledFeaturesCallback,"required":!0,"typeofString":"function","name":"hasEnabledFeaturesCallback"}),Kj.Utilities.verifyPassedArgs({"val":a.enabledFeatureNameCallback,"required":!0,"typeofString":"function","name":"enabledFeatureNameCallback"})},"defaults":function(){this.enabledFeatures=!1},"trackFeatureClick":function(a){var b=this.opt.hasEnabledFeaturesCallback(),c="ftr="+a+";";b===!0?this.enabledFeatures===!1&&(Kj.Tracking.trackGAEvent({"action":"FeatureAdBegin","label":c}),this.enabledFeatures=!0):this.enabledFeatures===!0&&(Kj.Tracking.trackGAEvent({"action":"FeatureAdCancel","label":c}),this.enabledFeatures=!1)},"trackFeatureEnabledOnPageLoad":function(){this.opt.hasEnabledFeaturesCallback()===!0&&this.trackFeatureClick(this.opt.enabledFeatureNameCallback())}},v=function(){function a(){d.$buttons=$(".poster-details-button")}function b(){d.$buttons.on({"click":function(){c($(this))}})}function c(a){var b={"action":"R2SExternalBegin"},c=a.data("button-type");void 0!==c&&""!==c&&(b.label="btn="+c+";"),Kj.Tracking.trackGAEvent(b)}var d={};return{"init":function(){a(),b()}}}();return{"test":{"WebTrendsSetup":a,"TrackWebTrendsEvent":b,"TrackGAEvent":c,"TrackCategorySelection":f,"TrackLocationSelection":g,"TrackAttributeSelection":h,"UpdateDataLayer":e,"TrackSocial":d,"TrackPostAdBeginButtons":j,"TrackFormsFlow":k,"DataLayerPageDetails":l,"OrderInvoiceInDataLayer":m,"TrackEditAdBeginButtons":i,"TrackActionAdSuccess":n,"TrackUserAccountActions":p,"TrackEditAdSuccess":q,"TrackPostAdSuccess":r,"TrackAdActivation":t,"TrackFeaturePurchase":u,"HasAdActivationError":s,"TrackPaymentSuccess":o},"initWebTrends":function(b){a.init(b)},"isWTLuckyNumber":function(){return a.isWTLuckyNumber()},"trackWebTrendsEvent":function(){b.init()},"trackGAEvent":function(a){c.init(a)},"updateDataLayer":function(a){e.init(a)},"initTrackCategorySelection":function(){f.init()},"initTrackLocationSelection":function(){g.init()},"initTrackAttributeSelection":function(){h.init()},"initTrackSocial":function(a){d.init(a)},"initTrackPostAdBeginButtons":function(){j.init()},"initTrackEditAdBeginButtons":function(){i.init()},"initTrackFormsFlow":function(){k.init()},"initDataLayerPageDetails":function(){return l.init()},"initOrderInvoiceInDataLayer":function(){return m.init()},"initTrackActionAdSuccess":function(a){n.init(a)},"initTrackUserAccountActions":function(a){p.init(a)},"initTrackEditAdSuccess":function(){q.init()},"initTrackPostAdSuccess":function(){r.init()},"initTrackAdActivation":function(a){t.init(a)},"initTrackFeaturePurchase":function(a){u.init(a)},"initHasAdActivationError":function(){return s.init()},"initTrackPaymentSuccess":function(){o.init()},"TrackPosterDetails":v,"api":{"TrackLocationSelection":{"trackLink":function(a){g.trackLink(a)},"trackForm":function(a){g.trackForm(a)}},"TrackAttributeSelection":{"trackLink":function(a){h.trackLink(a)},"trackForm":function(a){h.trackForm(a)}},"TrackFeaturePurchase":{"trackFeatureClick":function(a){u.trackFeatureClick(a)}}}}}();;Kj.Forms=function(){"use strict";var a={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.cache(),this.bindListeners(),this.populateFormPlaceholders()},"cache":function(){this.dom={},this.dom.$form=this.opt.form,this.dom.$formInputs=this.dom.$form.find("input[type=text], textarea, password, select"),this.dom.$formInputPlaceholders=this.dom.$form.find(" *[data-placeholder]"),this.dom.$formSubmitButton=Kj.Forms.api.Button.getFormSubmitButton(this.dom.$form)},"bindListeners":function(){var a=this;a.dom.$formInputPlaceholders.on({"focus":function(){a.removePlaceholder($(this))},"blur":function(){a.addPlaceholder($(this))}}),this.hasSubmitValidation(this.opt)&&a.dom.$form.on({"submit":function(){return Kj.Forms.api.Button.disableButton(a.dom.$formSubmitButton),a.isFormValid()===!0?(a.removePlaceholders(),!0):(Kj.Forms.api.Button.enableButton(a.dom.$formSubmitButton),!1)}})},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.form,"required":!0,"typeofString":"object","name":"form"}),Kj.Utilities.verifyPassedArgs({"val":a.submitValidation,"required":!1,"typeofString":"boolean","name":"submitValidation"}),this.hasSubmitValidation(a)&&(Kj.Utilities.verifyPassedArgs({"val":a.showInputMessages,"required":!0,"typeofString":"boolean","name":"showInputMessages"}),Kj.Utilities.verifyPassedArgs({"val":a.showBoxMessages,"required":!0,"typeofString":"boolean","name":"showBoxMessages"}),Kj.Utilities.verifyPassedArgs({"val":a.scrollToError,"required":!1,"typeofString":"boolean","name":"scrollToError"}))},"clearForm":function(){this.dom.$formInputs.val("").removeAttr("checked").removeAttr("selected"),this.dom.$form.find(" .error").removeClass("error"),this.populateFormPlaceholders()},"populateFormPlaceholders":function(){var a=this;a.dom.$formInputPlaceholders.each(function(){a.isFieldEmpty($(this))&&a.populateFormPlaceholdersValue($(this))})},"populateFormPlaceholdersValue":function(a){a.addClass("placeholder-text").val(a.data("placeholder"))},"removePlaceholder":function(a){a.hasClass("placeholder-text")&&a.val("").removeClass("placeholder-text")},"removePlaceholders":function(){var a=this;a.dom.$formInputPlaceholders.each(function(){a.isFieldEmpty($(this))&&a.removePlaceholder($(this))})},"addPlaceholder":function(a){this.isFieldEmpty(a)&&this.populateFormPlaceholdersValue(a)},"isFieldEmpty":function(a){return""===a.val()||a.val()===a.attr("data-placeholder")?!0:!1},"hasSubmitValidation":function(a){return"undefined"!=typeof a.submitValidation&&a.submitValidation===!0?!0:!1},"hasScrollError":function(){return"undefined"!=typeof this.opt.scrollToError&&this.opt.scrollToError===!0?!0:!1},"isFormValid":function(){return Kj.Forms.initValidateForm({"form":this.opt.form,"showInputMessages":this.opt.showInputMessages,"showBoxMessages":this.opt.showBoxMessages,"scrollToError":this.hasScrollError()})}},b={"init":function(a){return this.checkPassedArgs(a),this.opt=a,this.defaults(),this.cache(),this.clearPreviousErrors(),this.validateInputs(),this.hasScrollError()===!0&&this.scrollToError(),this.formValid},"defaults":function(){this.formValid=!0,this.errorClass="error",this.errorMessageClass=".field-message"},"cache":function(){this.dom={},this.dom.$form=this.opt.form,this.dom.$formInputs=this.dom.$form.find("input,textarea,file,password,select"),this.dom.$body=$("html, body"),this.opt.showInputMessages===!0&&(this.dom.$errorMessage=this.dom.$form.find(this.errorMessageClass)),this.opt.showBoxMessages===!0&&(this.dom.$errorBoxMessage=$(".message-container.error"))},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.form,"required":!0,"typeofString":"object","name":"form"}),Kj.Utilities.verifyPassedArgs({"val":a.showInputMessages,"required":!0,"typeofString":"boolean","name":"showInputMessages"}),Kj.Utilities.verifyPassedArgs({"val":a.showBoxMessages,"required":!0,"typeofString":"boolean","name":"showBoxMessages"}),Kj.Utilities.verifyPassedArgs({"val":a.scrollToError,"required":!1,"typeofString":"boolean","name":"scrollToError"})},"validateInputs":function(){var a,b=this;this.dom.$formInputs.each(function(){a=Kj.Forms.initValidateInput({"form":b.dom.$form,"inputField":$(this),"showInputMessages":b.opt.showInputMessages,"showBoxMessages":b.opt.showBoxMessages}),a===!1&&b.formValid===!0&&(b.formValid=!1)})},"hasScrollError":function(){return"undefined"!=typeof this.opt.scrollToError&&this.opt.scrollToError===!0?!0:!1},"scrollToError":function(){var a=this.findFormErrors();a.length&&this.dom.$body.animate({"scrollTop":a.offset().top-50},500)},"findFormErrors":function(){return this.dom.$form.find("label.error")},"clearPreviousErrors":function(){this.opt.showInputMessages===!0&&this.dom.$errorMessage.removeClass(this.errorClass),this.opt.showBoxMessages===!0&&this.dom.$errorBoxMessage.removeClass(this.errorClass)}},c={"init":function(a){return this.checkPassedArgs(a),this.opt=a,this.cache(),this.defaults(),this.clearPreviousError(),this.validateInputsTypes(this.dom.$inputField),this.isInputValid()},"cache":function(){this.dom={},this.dom.$form=this.opt.form,this.dom.$inputField=this.opt.inputField},"defaults":function(){this.inputValid=!0,this.requiredAttr="req",this.inputRegEx={"email":/^([A-Za-z0-9!#$%&'*+\-\/=?^_`{|}~]+(\.[A-Za-z0-9!#$%&'*+\-\/=?^_`{|}~]+)*)@(([A-Za-z0-9]+([A-Za-z0-9-]*[A-Za-z0-9]+)?\.)+[a-zA-Z]{2,7})$/,"number":/^[-+]?[\d]*\.?[\d]*$/,"phone":/^[()\- 0-9]*$/},this.fieldErrors=[],this.errorClass="error"},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.form,"required":!0,"typeofString":"object","name":"form"}),Kj.Utilities.verifyPassedArgs({"val":a.inputField,"required":!0,"typeofString":"object","name":"inputField"}),Kj.Utilities.verifyPassedArgs({"val":a.showInputMessages,"required":!0,"typeofString":"boolean","name":"showInputMessages"}),Kj.Utilities.verifyPassedArgs({"val":a.showBoxMessages,"required":!0,"typeofString":"boolean","name":"showBoxMessages"})},"isValidEmail":function(a){return this.inputRegEx.email.test($.trim(a))},"isValidPhone":function(a){return this.inputRegEx.phone.test(a)},"isValidCreditCard":function(a){for(var b=a.length,c=0,d=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],e=0;b--;)e+=d[c][parseInt(a.charAt(b),10)],c=+!c;return e%10===0&&e>0},"isValidNumber":function(a){return this.inputRegEx.number.test(a)},"isValidPrice":function(a){var b=$.parseNumber(a.val(),{"format":"#,###.##","locale":"fr_CA"===Kj.extVars.locale?"fr":"us"});return null!==b?(a.val(b),!0):(b=parseFloat(a.val()),null===b||isNaN(b)?!1:(b=Math.round(100*b)/100,a.val(b),!0))},"isUnderMaxLength":function(a){var b=a.attr("maxlength"),c=a.val().length;return!("undefined"!=typeof b&&c>b)},"isOverOrEqualMinLength":function(a){var b=a.attr("data-minlength"),c=a.val().length;return!("undefined"!=typeof b&&b>c)},"isNumberInRange":function(a){var b=!0,c=parseFloat(a.val()),d=a.attr("data-max"),e=a.attr("data-min");return"undefined"!=typeof d&&c>d&&(b=!1),"undefined"!=typeof e&&e>c&&(b=!1),b},"numberRangeErrorMessage":function(a){var b=a.attr("data-max"),c=a.attr("data-min"),d=this.determineNumberRangeErrorMessage(c,b);return d=d.replace("{{max}}",b),d=d.replace("{{min}}",c)},"determineNumberRangeErrorMessage":function(a,b){var c=Kj.extVars.validationMessages.numberRange;return"undefined"==typeof a&&"undefined"!=typeof b?c=Kj.extVars.validationMessages.numberMax:"undefined"!=typeof a&&"undefined"==typeof b&&(c=Kj.extVars.validationMessages.numberMin),c},"maxLengthErrorMessage":function(a){var b=Kj.extVars.validationMessages.maxlength,c=a.attr("maxlength");return b=b.replace("{{max}}",c)},"minLengthErrorMessage":function(a){var b=Kj.extVars.validationMessages.minlength,c=a.attr("data-minlength");return b=b.replace("{{min}}",c)},"isMatchingInput":function(a){return this.getMatchingInputValue(a)===a.val()?!0:!1},"isInputFilled":function(a){return"undefined"!=typeof a.val()&&""!==$.trim(a.val())&&a.val()!==a.attr("data-placeholder")?!0:!1},"isInputRequired":function(a){return void 0!==a.attr(this.requiredAttr)?!0:!1},"isChecked":function(a){return a.is(":checked")},"getMatchingInputValue":function(a){return $("#"+a.attr("data-matching")).val()},"hasMatchingInput":function(a){return"undefined"!=typeof a.attr("data-matching")&&$.trim(""!==a.attr("data-matching"))?!0:!1},"inputType":function(a){var b;return"text"===a.attr("type")||a.is("textarea")||"password"===a.attr("type")?b="text":"radio"===a.attr("type")?b="radio":"file"===a.attr("type")?b="file":a.is("select")===!0&&(b="select"),b},"validateInputsTypes":function(a){var b=this.inputType(a),c=a.attr("name");switch(b){case"radio":this.isInputRequired(a)&&(this.validateRadioButtons(c)||this.addError(c,Kj.extVars.validationMessages.radioButton));break;case"text":this.validateInputText(a,c);break;case"file":!this.isInputFilled(a)&&this.isInputRequired(a)&&this.addError(c,Kj.extVars.validationMessages.req);break;case"select":this.isInputRequired(a)&&!this.isInputFilled(a)&&this.addError(c,Kj.extVars.validationMessages.req)}},"validateRadioButtons":function(a){var b=this.dom.$form.find('[name="'+a+'"]'),c=b.length,d=0,e=!1;for(d;c>d;d++)this.isChecked(b.eq(d))&&(e=!0);return e},"validateInputText":function(a,b){this.isInputFilled(a)?this.isUnderMaxLength(a)?this.isOverOrEqualMinLength(a)?this.hasMatchingInput(a)?this.isMatchingInput(a)?this.validateInputTextTypes(a):this.addError(b,Kj.extVars.validationMessages.matching):this.validateInputTextTypes(a):this.addError(b,this.minLengthErrorMessage(a)):this.addError(b,this.maxLengthErrorMessage(a)):this.isInputRequired(a)&&this.addError(b,Kj.extVars.validationMessages.req)},"validateInputTextTypes":function(a){switch(a.attr("data-type")){case"email":this.isValidEmail(a.val())||this.addError(a.attr("name"),Kj.extVars.validationMessages.email);break;case"phone":this.isValidPhone(a.val())||this.addError(a.attr("name"),Kj.extVars.validationMessages.phone);break;case"number":this.isValidNumber(a.val())?this.isNumberInRange(a)||this.addError(a.attr("name"),this.numberRangeErrorMessage(a)):this.addError(a.attr("name"),Kj.extVars.validationMessages.number);break;case"price":this.isValidPrice(a)?this.isNumberInRange(a)||this.addError(a.attr("name"),this.numberRangeErrorMessage(a)):this.addError(a.attr("name"),Kj.extVars.validationMessages.number);break;case"creditcard":this.isValidCreditCard(a.val())||this.addError(a.attr("name"),Kj.extVars.validationMessages.creditcard)}},"addError":function(a,b){var c={"field":a,"errmsg":b};this.fieldErrors.push(c),this.inputValid=!1},"isInputValid":function(){return this.inputValid===!1&&Kj.Forms.initDisplayFormErrors({"form":this.dom.$form,"showInputMessages":this.opt.showInputMessages,"showBoxMessages":this.opt.showBoxMessages,"fieldErrors":this.fieldErrors}),this.inputValid},"clearPreviousError":function(){var a=Kj.Forms.api.Input.getFieldLabel({"$input":this.dom.$inputField,"$form":this.dom.$form});a.removeClass(this.errorClass),this.dom.$inputField.removeClass(this.errorClass)}},d={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.defaults(),this.cache(),this.throwErrors()},"cache":function(){this.dom={},this.dom.$form=this.opt.form,this.dom.$formInputs=this.dom.$form.find("input, textarea, select"),this.opt.showInputMessages===!0&&(this.dom.$errorMessage=this.dom.$form.find(this.errorMessageClass))},"defaults":function(){this.errorClass="error",this.errorMessageClass=".field-message",this.groupErrorMessages={}},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.form,"required":!0,"typeofString":"object","name":"form"}),Kj.Utilities.verifyPassedArgs({"val":a.showInputMessages,"required":!0,"typeofString":"boolean","name":"showInputMessages"}),Kj.Utilities.verifyPassedArgs({"val":a.showBoxMessages,"required":!0,"typeofString":"boolean","name":"showBoxMessages"}),Kj.Utilities.verifyPassedArgs({"val":a.fieldErrors,"required":!0,"typeofString":"object","name":"fieldErrors","lengthMin":!0})},"getFieldInput":function(a){return this.dom.$form.find('[name="'+a+'"]').not("a")},"getFieldErrorContainer":function(a){return this.dom.$form.find(this.errorMessageClass+'[data-for="'+a+'"]')},"getGroupName":function(a){return a.attr("data-group")},"isInAGroup":function(a){return"undefined"!=typeof a.attr("data-group")?!0:!1},"getGroupErrorContainer":function(a){return this.dom.$form.find(this.errorMessageClass+'[data-for-group="'+a+'"]')},"addGroupErrorMessage":function(a,b){"undefined"!=typeof this.groupErrorMessages[a]&&this.groupErrorMessages[a].constructor===Array?this.groupErrorMessages[a].push(b):this.groupErrorMessages[a]=[b]},"hasGroupErrorMessages":function(){return _.size(this.groupErrorMessages)>0?!0:!1},"throwErrors":function(){var a=0,b=this.opt.fieldErrors.length,c=[];for(a;b>a;a++)c.push({"text":this.opt.fieldErrors[a].errmsg,"url":"#"+this.getFieldInput(this.opt.fieldErrors[a].field).attr("id")}),this.throwError(this.opt.fieldErrors[a]);this.opt.showBoxMessages===!0&&this.boxErrorMessage(c),this.hasGroupErrorMessages()===!0&&this.throwGroupErrors()},"throwError":function(a){var b=this.getFieldInput(a.field),c=b.attr("id"),d=Kj.Forms.api.Input.getFieldLabel({"$input":b,"$form":this.dom.$form});d.addClass(this.errorClass),b.addClass(this.errorClass),this.opt.showInputMessages===!0&&this.inputErrorMessage(a,c),this.isInAGroup(b)&&this.addGroupErrorMessage(this.getGroupName(b),a.errmsg)},"throwGroupErrors":function(){for(var a in this.groupErrorMessages)this.groupErrorMessages.hasOwnProperty(a)&&this.throwGroupError(a)},"throwGroupError":function(a){var b=this.getGroupErrorContainer(a);this.groupErrorContainerAlreadyExists(b)?this.addToGroupContainerMessage(b,a):this.createGroupContainerMessage(b,a)},"createGroupContainerMessage":function(a,b){var c=Kj.Utilities.useTemplate({"template":"groupValidationErrors","data":{"mainErrorMessage":Kj.extVars.validationMessages.group,"errorMessages":_.uniq(this.groupErrorMessages[b])}});a.addClass("error").addClass("group"),a.html(c)},"addToGroupContainerMessage":function(a,b){var c=a.find("ul"),d=this.getUniqueGroupErrors(a,b),e=Kj.Utilities.useTemplate({"template":"groupValidationErrors","data":{"errorMessages":d}});d.length>0&&c.append(e)},"getUniqueGroupErrors":function(a,b){var c=[],d=a.find("li");return d.each(function(){c.push($(this).text())}),_.difference(this.groupErrorMessages[b],c)},"groupErrorContainerAlreadyExists":function(a){return a.hasClass("error")&&a.find("ul").length>0?!0:!1},"inputErrorMessage":function(a,b){var c=this.getFieldErrorContainer(b);c.html(a.errmsg),c.addClass(this.errorClass)},"boxErrorMessage":function(a){Kj.initMessages({"setMessage":!0,"messageData":{"messageClass":"error","messageTextHeadline":Kj.extVars.validationMessages.headline,"links":a}})}},e={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.defaults(),this.cache(),this.clearErrors()},"cache":function(){this.dom={},this.dom.$form=this.opt.form,this.dom.$formInputs=this.dom.$form.find("input,textarea,select")},"defaults":function(){this.errorClass="error",this.errorMessageClass=".field-message"},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.form,"required":!0,"typeofString":"object","name":"form"}),Kj.Utilities.verifyPassedArgs({"val":a.fieldErrors,"required":!0,"typeofString":"object","name":"fieldErrors","lengthMin":!0})},"getFieldInput":function(a){return this.dom.$form.find('[name="'+a+'"]')},"getFieldErrorContainer":function(a){return this.dom.$form.find(this.errorMessageClass+'[data-for="'+a+'"]')},"clearErrors":function(){var a=0,b=this.opt.fieldErrors.length,c=[];for(a;b>a;a++)c.push({"text":this.opt.fieldErrors[a].errmsg,"url":"#"+this.getFieldInput(this.opt.fieldErrors[a].field).attr("id")}),this.clearError(this.opt.fieldErrors[a])},"clearError":function(a){var b=this.getFieldInput(a.field),c=b.attr("id"),d=Kj.Forms.api.Input.getFieldLabel({"$input":b,"$form":this.dom.$form});d.removeClass(this.errorClass),b.removeClass(this.errorClass),this.clearInputErrorMessage(a,c)},"clearInputErrorMessage":function(a,b){var c=this.getFieldErrorContainer(b);c.html(""),c.removeClass(this.errorClass)}},f={"getFieldLabel":function(a){var b=a.$form.find('label[for="'+a.$input.attr("id")+'"]');return b.length>0?b:a.$input.parent()}},g={"enableButton":function(a){a.prop("disabled",!1),a.removeClass("disabled")},"disableButton":function(a){a.prop("disabled",!0),a.addClass("disabled")},"getFormSubmitButton":function(a){return a.find("*[type=submit]")}},h={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.cache(),this.bindListeners()},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.form,"required":!0,"typeofString":"object","name":"form"}),Kj.Utilities.verifyPassedArgs({"val":a.matchingExtensions,"required":!0,"typeofString":"string","name":"matchingExtensions","lengthMin":!0})},"cache":function(){this.dom={"fileUploadInput":$(".file-upload-input",this.opt.form),"fileUploadWrapper":$(".file-input-wrapper",this.opt.form),"fileUploadButton":$(".file-upload-button",this.opt.form)}},"bindListeners":function(){var a=this;a.dom.fileUploadInput.on({"mouseenter":function(){a.dom.fileUploadButton.addClass("hover")},"mouseleave":function(){a.dom.fileUploadButton.removeClass("hover")}})},"hasFile":function(){return""!==this.dom.fileUploadInput.val()?!0:!1},"hasValidFileType":function(){var a=new RegExp("^("+this.opt.matchingExtensions+")$");return a.test(this.getFileExtension())},"getFileExtension":function(){return this.getFilename().match(/[^.]*$/)[0].toLowerCase()},"getFilename":function(){return this.dom.fileUploadInput.val().match(/[^/\\]*$/)[0]},"throwError":function(){Kj.Forms.initDisplayFormErrors({"form":this.opt.form,"showInputMessages":!0,"showBoxMessages":!1,"fieldErrors":[{"field":this.dom.fileUploadInput.attr("name"),"errmsg":Kj.extVars.validationMessages.fileType}]})},"clearError":function(){this.dom.fileUploadWrapper.find(".error").removeClass("error")},"isValidFile":function(){var a;return this.clearError(),this.hasFile()&&(this.hasValidFileType()?a=!0:(this.throwError(),a=!1)),a}},i={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.cache(),this.bindListeners(),Kj.Forms.initUploadFile({"form":this.opt.form,"matchingExtensions":this.opt.matchingExtensions})},"cache":function(){this.dom={"fileUploadInput":$(".file-upload-input",this.opt.form),"fileUploadWrapper":$(".file-input-wrapper",this.opt.form),"fileUploadButton":$(".file-upload-button",this.opt.form)}},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.form,"required":!0,"typeofString":"object","name":"form"}),Kj.Utilities.verifyPassedArgs({"val":a.matchingExtensions,"required":!0,"typeofString":"string","name":"matchingExtensions","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.callbackSuccessful,"required":!0,"typeofString":"function","name":"callbackSuccessful"}),Kj.Utilities.verifyPassedArgs({"val":a.callbackUnsuccessful,"required":!1,"typeofString":"function","name":"callbackUnsuccessful"})},"bindListeners":function(){var a=this;a.dom.fileUploadInput.on({"change":function(){a.isValidFile()}})},"hasUnsuccessfulCallback":function(){return"undefined"!=typeof this.opt.callbackUnsuccessful?!0:!1},"isValidFile":function(){Kj.Forms.api.UploadFile.isValidFile()===!0?this.opt.callbackSuccessful():this.hasUnsuccessfulCallback()&&this.opt.callbackUnsuccessful()}},j={"init":function(a){this.opt=a,this.defaults(),this.cache(a),this.checkPassedArgs(a),this.applyTraits()},"defaults":function(){this.attributes=[""]},"cache":function(){this.dom={},this.dom.$container=this.opt&&this.opt.container?this.opt.container:$("body")},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"typeofString":"object","name":"argument"}),"object"==typeof a&&Kj.Utilities.verifyPassedArgs({"val":a.container,"typeofString":"object","name":"container","lengthMin":!0})},"applyTraits":function(){var a,b,c,d=this;for(a in d.glossary)d.glossary.hasOwnProperty(a)&&(b="[data-"+a+"]",$(b,d.dom.$container).each(function(){c=d.getData(a,this),d.glossary[a].init(this,c)}))},"getData":function(a,b){var c,d,e,f=this.glossary[a].keys,g={},h="data-"+a,i=0;for(i;i<f.length;i++){if(c=f[i],d="_self"===c.name?h:h+"-"+c.name,e=$(b).attr(d),c.required===!0&&"undefined"==typeof e)throw new Error("Please define property "+d+' for trait "'+a+".");c.multiple===!0&&(e="undefined"!=typeof e?e.split(","):e),"undefined"!=typeof c["default"]&&"undefined"==typeof e&&(e=c["default"]),g[c.name]=e}return g},"glossary":{}};j.glossary.dependent={"keys":[{"name":"_self"},{"name":"on","required":!0},{"name":"change","required":!1,"multiple":!0,"default":"disabled"},{"name":"group","required":!1,"default":!0}],"handlers":{"disabled":{"off":function(){$(this).prop("disabled",!0)},"on":function(){$(this).prop("disabled",!1)}},"visibility":{"off":function(){$(this).hide()},"on":function(){$(this).show()}},"required":{"off":function(){$(this).removeAttr("req")},"on":function(){$(this).attr("req",!0)}},"focus":{"off":function(){},"on":function(){$(this).focus()}},"clear":{"off":function(){$(this).val("")},"on":function(){}}},"init":function(a,b){function c(){var c,e,g=d.is(":checked");if(g)for(c=0;c<b.change.length;c++)e=f.handlers[b.change[c]],"undefined"!=typeof e&&e.on.call(a);else for(c=0;c<b.change.length;c++)e=f.handlers[b.change[c]],"undefined"!=typeof e&&e.off.call(a)}var d=$(b.on),e=$('[name="'+d.attr("name")+'"]'),f=this;(0===e.length||b.group===!1)&&(e=d),e.bind("change",c).trigger("change")}};var k={"init":function(){this.cache(),this.bindListeners()},"cache":function(){this.dom={"sortOrderForm":$("#SortOrderForm"),"sortOrderField":$("#SortField"),"sortSelectField":$("#SortSelectField")}},"bindListeners":function(){var a=this;this.dom.sortSelectField.on({"change":function(){a.updateSortOrderForm($(this).val())}})},"updateSortOrderForm":function(a){this.dom.sortOrderField.val(a),this.dom.sortOrderForm.submit()}};return{"test":{"Form":a,"ValidateForm":b,"DisplayFormErrors":d,"ClearFormErrors":e,"UploadFile":h,"Traits":j,"UploadFileButton":i,"ValidateInput":c,"SortAds":k,"Input":f,"Button":g},"initForm":function(b){return a.init(b),{"clearForm":function(){a.clearForm()},"populateFormPlaceholders":function(){a.populateFormPlaceholders()}}},"initTraits":function(a){return j.init(a)},"initDisplayFormErrors":function(a){return d.init(a)},"initClearFormErrors":function(a){return e.init(a)},"initUploadFile":function(a){return h.init(a)},"initValidateForm":function(a){return b.init(a)},"initUploadFileButton":function(a){return i.init(a)},"initValidateInput":function(a){return c.init(a)},"initSortAds":function(){return k.init()},"api":{"UploadFile":{"hasFile":function(){return h.hasFile()},"getFilename":function(){return h.getFilename()},"isValidFile":function(){return h.isValidFile()}},"Input":{"getFieldLabel":function(a){return f.getFieldLabel(a)}},"Button":{"enableButton":function(a){g.enableButton(a)},"disableButton":function(a){g.disableButton(a)},"getFormSubmitButton":function(a){return g.getFormSubmitButton(a)}},"ValidateForm":{"scrollToError":function(){b.scrollToError()}}}}}();;Kj.Header=function(){var a={"init":function(a){this.checkPassedArgs(a),this.opt=a,Kj.initSelectLocation(this.opt),this.cache(),this.bindListeners()},"cache":function(){this.dom=[],this.dom.currentLocation=$("#CurrentLocation"),this.dom.listsContainer=$("#ListsContainer"),this.dom.locationLabel=$("#LocationLabel"),this.dom.cancelButton=$(".loc-cancel")},"bindListeners":function(){var a=this;$(document).mouseup(function(b){0===a.dom.currentLocation.has(b.target).length&&a.hideMenu()}),a.dom.locationLabel.click(function(b){a.dom.listsContainer.is(":hidden")?(a.showMenu(),Kj.api.SelectLocation.resetLocations()):a.hideMenu()}),a.dom.cancelButton.click(function(){return a.hideMenu(),!1})},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0})},"hideMenu":function(){this.dom.currentLocation.removeClass("open"),this.dom.listsContainer.hide()},"showMenu":function(){this.dom.currentLocation.addClass("open"),this.dom.listsContainer.show()}},b={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.cache(),this.bindListeners()},"cache":function(){this.dom=[],this.dom.dropDown=this.opt.dropDown},"bindListeners":function(){this.dom.dropDown.on({"mouseenter":function(){$(this).addClass("hover")},"mouseleave":function(){$(this).removeClass("hover"),$(this).removeClass("open")},"click":function(){$(this).toggleClass("open")}})},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.dropDown,"required":!0,"typeofString":"object","name":"dropDown","lengthMin":!0})}},c={"init":function(){this.cache(),this.bindListeners(),Kj.Header.initDropDown({"dropDown":this.dom.searchIn})},"cache":function(){this.dom=[],this.dom.searchIn=$("#SearchIn"),this.dom.cLinkMslctbx=$(".c-lnk-mslctbx"),this.dom.searchCategoryValue=$("#SearchCategoryValue"),this.dom.searchCategorySelected=$("#SearchCategorySelected")},"bindListeners":function(){var a=this;a.dom.cLinkMslctbx.click(function(b){b.preventDefault(),a.dom.searchCategoryValue.val($(this).attr("id")),a.dom.searchCategorySelected.text($(this).text())})}},d={"init":function(a){this.opt=a,this.cache(),this.bindListeners()},"cache":function(){this.dom=[],this.dom.searchForm=$("#SearchForm"),this.dom.searchInput=$("#SearchInput"),this.dom.searchContainer=$("#InputContainer"),this.dom.searchClear=$("#InputClear"),this.dom.searchGoButton=$("#SearchGoButton")},"bindListeners":function(){var a=this;a.dom.searchInput.focus(function(){a.dom.searchContainer.addClass("active")}),a.dom.searchInput.blur(function(){""!==a.dom.searchInput.val()&&a.dom.searchClear.addClass("active"),a.dom.searchContainer.removeClass("active")}),a.dom.searchClear.mousedown(function(){a.dom.searchInput.val(""),a.dom.searchClear.removeClass("active")}),a.dom.searchGoButton.click(function(){a.dom.searchForm.submit()})}},e={"init":function(){this.cache(),this.bindListeners()},"cache":function(){this.dom={"userLogged":$("#UserLogged"),"userLogOut":$("#Logout")}},"bindListeners":function(){var a=this;this.dom.userLogged.on({"mouseleave":function(){a.removeDropDown($(this))},"click":function(b){a.toggleDropDown($(this))}}),this.dom.userLogOut.on({"click":function(b){b.preventDefault(),a.logOut($(this),b)}})},"removeDropDown":function(a){a.removeClass("drop-down")},"toggleDropDown":function(a){a.toggleClass("drop-down")},"logOut":function(a,b){var c=a.attr("href");Kj.Tracking.trackGAEvent({"action":"UserLogoutAttempt","delayHref":c,"event":b})}},f={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.cache(),this.bindListeners()},"cache":function(){this.dom={},this.dom.changeLocaleLink=$("#ChangeLocale")},"bindListeners":function(){var a=this;this.dom.changeLocaleLink.click(function(b){b.preventDefault();var c=Kj.Utilities.changeUrlParam({"url":location.search,"paramName":"siteLocale","paramValue":a.opt.locale});location.search=c})},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.locale,"required":!0,"typeofString":"string","name":"locale","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.enableSearchNavigation,"required":!0,"typeofString":"boolean","name":"enableSearchNavigation"})}},g={"init":function(a){this.checkPassedArgs(a),this.opt=a,this.cache(),this.defaults(),this.bindListeners()},"defaults":function(){this.timeoutId,this.ajaxCalldelay=300,this.search={},this.search.query="",this.search.catId="",this.search.locId="",this.search.otherLang=""},"cache":function(){this.dom=[],this.dom.searchForm=$("#SearchForm"),this.dom.searchInput=$("#SearchInput"),this.dom.suggestedSearches=$("#SuggestedSearches"),this.dom.searchCategoryValueInput=$("#SearchCategoryValue")},"bindListeners":function(){var a=this;a.dom.searchInput.on({"keyup":function(){a.checkSuggestions()},"focus":function(){a.showSuggestions()},"blur":function(){}}),a.dom.suggestedSearches.on({"click":function(){a.selectedSuggestion($(this))},"hover":function(){}},"li"),a.dom.suggestedSearches.on("click","a",function(a){a.preventDefault()})},"checkPassedArgs":function(a){Kj.Utilities.verifyPassedArgs({"val":a,"required":!0,"typeofString":"object","name":"argument","lengthMin":!0}),Kj.Utilities.verifyPassedArgs({"val":a.ajaxUrl,"required":!0,"typeofString":"string","name":"ajaxUrl","lengthMin":!0})},"selectedSuggestion":function(a){this.dom.searchInput.val(a.attr("title")),this.dom.searchCategoryValueInput.val(a.data("cat-id")),this.dom.searchForm.submit()},"moveHover":function(){},"isBlankKeyword":function(a){var b=!0;return""!==a&&(b=!1),b},"isNewKeyword":function(a){var b=!0;return this.search.query===a&&(b=!1),b},"getNewKeywords":function(){return $.trim(this.dom.searchInput.val())},"checkSuggestions":function(){var a=this.getNewKeywords();this.isBlankKeyword(a)?this.resetSuggestions():(this.showSuggestions(),this.isNewKeyword(a)?(this.search.query=a,this.setAjaxCall()):this.showSuggestions())},"setAjaxCall":function(){var a=this;clearTimeout(a.timeoutId),a.timeoutId=setTimeout(a.callSuggestions(),a.ajaxCalldelay)},"callSuggestions":function(){var a=this;$.ajax({"url":a.opt.ajaxUrl,"data":a.search,"success":function(b){b.length>0?a.renderDropDown(b):a.resetSuggestions()}})},"renderDropDown":function(a){var b=this;this.dom.suggestedSearches.html(b.buildDropDown(a))},"buildDropDown":function(a){var b;for(b in a)a.hasOwnProperty(b)&&(a[b].suggestionClasses="",0!==a[b].categoryId&&(a[b].suggestionClasses="hasCategory"));return Kj.Utilities.useTemplate({"template":"suggestionBox","data":a})},"showSuggestions":function(){this.dom.suggestedSearches.show()},"hideSuggestions":function(){this.dom.suggestedSearches.hide()},"clearSuggestions":function(){this.dom.suggestedSearches.html("")},"resetSuggestions":function(){this.hideSuggestions(),this.clearSuggestions()}};return{"test":{"LocationPicker":a,"SearchCategories":c,"SearchInput":d,"DropDown":b,"UserLoggedIn":e,"SuggestionBox":g,"ChangeLocale":f},"initLocationPicker":function(b){return a.init(b)},"initSearchCategories":function(){return c.init()},"initSearchInput":function(){return d.init()},"initDropDown":function(a){return b.init(a)},"initUserLoggedIn":function(){return e.init()},"initSuggestionBox":function(a){return g.init(a)},"initChangeLocale":function(a){return f.init(a)},"api":{"SuggestionBox":{"resetSuggestions":function(){return g.resetSuggestions()}}}}}();